<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <div th:replace="bootstrap/title.html"></div>
    <div th:replace="bootstrap/bootstrap_head.html"></div>
</head>

<body>
    <div class="container">
        <div th:replace="bootstrap/bootstrap_nav_header.html"></div>

        <h1>Compare Counties</h1>
        <h5>Results</h5>
        <form action="#" th:action="@{/county/compare-results}" th:object="${compareCounty}" method="get" id="compareCounty">

            <select id="county1" name="county1" form="compareCounty" class="form-control">
	        <option value="0">Select County 1</option>
                <option th:each="county : ${counties}" th:value="${county.name}" th:text="${county.name}">
                </option>
            </select>
            <script>
                window.onload = function() {
                    var selItem = sessionStorage.getItem("SelItem");  
                    $('#county1').val(selItem);
                }
                $('#county1').change(function() { 
                    var selVal = $(this).val();
                    sessionStorage.setItem("SelItem", selVal);
                });             }
            </script>
	        <select id="county2" name="county2" form="compareCounty" class="form-control">
	            <option value="0">Select County 2</option>
		        <option th:each="county : ${counties}" th:value="${county.name}" th:text="${county.name}">
		        </option>
            </select>
            <script>
                window.onload = function() {
                    var selItem = sessionStorage.getItem("SelItem");  
                    $('#county2').val(selItem);
                }
                $('#county2').change(function() { 
                    var selVal = $(this).val();
                    sessionStorage.setItem("SelItem", selVal);
                });             }
            </script>
            
            <input type="submit" class="btn btn-primary" value="Compare">

        </form>
	    <canvas id="myChart" width="400" height="400"></canvas>

        <div th:replace="bootstrap/bootstrap_footer.html"></div>
    </div>
    <div th:replace="bootstrap/bootstrap_scripts.html"></div>
    <script>
        var e1 = document.getElementById("county1");
        var e2 = document.getElementById("county2");
        var strCounty1 = e1.options[e1.selectedIndex].text;
        var strCounty2 = e2.options[e2.selectedIndex].text;
        var ctx = document.getElementById("myChart").getContext("2d");

        var data = {
            labels: ["Chocolate", "Vanilla", "Strawberry"],
            datasets: [{
                label: strCounty1,
                backgroundColor: "blue",
                data: [3, 7, 4]
            }, {
                label: strCounty2,
                backgroundColor: "red",
                data: [4, 3, 5]
            }]
        };

        var myBarChart = new Chart(ctx, {
            type: 'bar',
            data: data,
            options: {
                barValueSpacing: 20,
                scales: {
                    yAxes: [{
                        ticks: {
                            min: 0,
                        }
                    }]
                }
            }
        });
    </script>
</body>

</html>
